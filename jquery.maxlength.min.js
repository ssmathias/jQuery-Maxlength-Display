(function(a){var b=function(f,c){var e={displayTarget:null,targetPin:"top-left",parentPin:"top-right",allowPositionToggle:true,style:{},lengths:{"long":100,medium:50,"short":20,empty:0}};if(f){if(f.targetPin){e.targetPin=f.targetPin}if(f.parentPin){e.parentPin=f.parentPin}if(f.allowPositionToggle!==undefined&&f.allowPositionToggle!==null){e.allowPositionToggle=(f.allowPositionToggle==true)}if(f.style){e.style=f.style}if(f.lengths){e.lengths=f.lengths}if(f.displayTarget){e.displayTarget=a(f.displayTarget)}}for(var d in e){this[d]=e[d]}this.scope=c;this.init()};b.prototype.init=function(){var c=this;for(var e in c.scope){var d=c.scope[e];if(parseInt(e)=="NaN"){continue}if(d.tagName=="TEXTAREA"||d.tagName=="INPUT"){this.initializeElement(a(d))}else{this.scope.find("input[maxlength], textarea[maxlength]").each(function(){c.initializeElement(a(this))})}}};b.prototype.initializeElement=function(e){var f=this,d,c;if(typeof e.attr=="undefined"){e=a(e)}if(e.data("maxlength-display-initialized")=="true"){return true}d=parseInt(e.attr("maxlength"));if(typeof d=="undefined"||typeof d=="NaN"){if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Could not convert "+e.attr("maxlength")+" to an integer. Ignoring.");return false}}e.data("maxlength-display-initialized","true");c=f.displayTarget;if(e.data("maxlength-display-target")){c=a("#"+e.data("maxlength-display-target"))}if(c&&c.length>0){e.focus(function(){c.addClass("maxlength-parent-has-focus")}).blur(function(){c.removeClass("maxlength-parent-has-focus")});f.setLengthDefinitionData(e,c);f.updateDisplayMarkup(e,c)}else{c=f.createDisplayTarget(e)}e.bind("keyup change",function(){f.updateDisplayMarkup(e,c)}).bind("keypress",function(h){var g=e.val().length;if(g+1>d){e.val(e.val().substring(0,d));h.stopPropagation();h.preventDefault()}});return true};b.prototype.createDisplayTarget=function(d){var j=this,i=a("<div></div>"),g=a("<div></div>"),h={},k=j.allowPositionToggle,f=d.data("maxlength-allow-position-toggle");for(var c in j.style){h[c]=j.style[c]}if(d.data("maxlength-target-style")){overrideStyle=j.objectifyCssString(d.data("maxlength-target-style"));for(var e in overrideStyle){h[e]=overrideStyle[e]}}j.setLengthDefinitionData(d,g);j.updateDisplayMarkup(d,g);g.addClass("maxlength-display-target");if(typeof f!="undefined"){var f=d.data("maxlength-allow-position-toggle");if(f.length>0){f=a.trim(f.toLowerCase())}if(a.inArray(f,["true","false"])){k=(f=="true")}else{if(typeof console!="undefined"){console.warn('[jQuery Maxlength Display] allow position toggle value "'+f+'" not recognized. Ignoring override.')}}}i.addClass("maxlength-display-target-parent").css({"float":"left"}).append(g).data("maxlength-parent-pin",j.getPinDefinition(d,"parent")).data("maxlength-my-pin",j.getPinDefinition(d,"target")).data("maxlength-can-toggle",k).data("parent-id",d.attr("id"));a("body").append(i);g.width(g.width()).css(h);i.hide();j.updateDisplayLocation(d,i);d.focus(function(){g.addClass("maxlength-parent-has-focus");i.addClass("maxlength-parent-has-focus").show();j.updateDisplayLocation(d,i)}).blur(function(){g.removeClass("maxlength-parent-has-focus");i.removeClass("maxlength-parent-has-focus").hide()});if(j.allowPositionToggle){a(window).bind("scroll resize",function(){j.updateDisplayLocation(d,i)})}return g};b.prototype.calculateRemainingChars=function(e){if(typeof e.attr=="undefined"){e=a(e)}if(typeof e=="undefined"){return false}if(e.attr("maxlength")){var c=parseInt(e.attr("maxlength")),d=e.val().length;if(c===false){if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Could not parse integer from value: "+e.attr("maxlength"))}return false}if(c<=d){return 0}else{return c-d}}else{return false}};b.prototype.updateDisplayMarkup=function(g,e){var j=this,i=j.calculateRemainingChars(g),k="",f=null,c;e=a(e);if(typeof e=="undefined"){return false}if(i===false){return false}c=j.lengths;for(var d in c){e.removeClass("maxlength-remaining-"+d);var h=c[d];if(i<=h&&(h<f||f==null)){k="maxlength-remaining-"+d;f=h}}e.addClass(k).html(i)};b.prototype.getPinDefinition=function(g,c){var d=this,f={parent:["top","right"],target:["top","left"]},e=false;pinLocation=false;overridePinLocation=false;switch(c){case"parent":e=d.parentPin.toLowerCase().split("-");pinLocation=g.data("maxlength-pin-location");overridePinLocation=f.parent;break;case"target":e=d.targetPin.toLowerCase().split("-");pinLocation=g.data("maxlength-target-pin-location");overridePinLocation=f.target;break}if(typeof pinLocation=="undefined"){pinLocation=e;if(!a.inArray(pinLocation[0],["top","bottom"])==-1){if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Invalid vertical pin location: "+pinLocation[0]+" - Overriding to "+overridePinLocation[0])}pinLocation[0]=overridePinLocation[0]}if(!a.inArray(pinLocation[1],["left","right"])==-1){if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Invalid horizontal pin location: "+pinLocation[1]+" - Overriding to "+overridePinLocation[1])}pinLocation[1]=overridePinLocation[1]}}else{pinLocation=pinLocation.toLowerCase().split("-");if(pinLocation.length!=2){if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Invalid pin location: "+pinLocation.join("-")+" - Using default.")}pinLocation=e}else{if(!a.inArray(pinLocation[0],["top","bottom"])==-1){if(a.inArray(e[0],["top","bottom"])){if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Invalid vertical pin location: "+pinLocation[0]+" - Using default.")}pinLocation[0]=e[0]}else{if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Invalid vertical pin location: "+pinLocation[0]+" - Overriding to "+overridePinLocation[0])}pinLocation[0]=overridePinLocation[0]}}if(!a.inArray(pinLocation[1],["left","right"])==-1){if(a.inArray(e[1],["left","right"])){if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Invalid horizontal pin location: "+pinLocation[1]+" - Using default.")}pinLocation[1]=e[1]}else{if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Invalid horizontal pin location: "+pinLocation[1]+" - Overriding to "+overridePinLocation[1])}pinLocation[1]=overridePinLocation[1]}}}}return pinLocation};b.prototype.setLengthDefinitionData=function(i,c){var f=this,d={},h,j,g,e;for(h in f.lengthDefinition){d[h]=f.lengthDefinition[h]}if(i.data("maxlength-length-classes")){j=f.objectifyCssString(i.data("maxlength-length-classes"));for(g in j){e=parseInt(j[g]);if(typeof e=="undefined"||typeof e=="NaN"){if(typeof console!="undefined"){console.warn('[jQuery Maxlength Display] - Override length class "'+g+'" value "'+j[g]+'" could not be parsed as an integer. Ignoring')}continue}d[g]=e}}c.data("maxlength-length-classes",d);return true};b.prototype.updateDisplayLocation=function(e,c){var j=this,k=c.data("maxlength-parent-pin"),d=c.data("maxlength-my-pin"),f={position:"absolute",top:"",left:""},h=((c.data("maxlength-can-toggle")!==undefined&&c.data("maxlength-can-toggle")===true)||(c.data("maxlength-can-toggle")===undefined&&j.allowPositionToggle===true)),g=e.offset(),i={};g.right=g.left+e.outerWidth();g.bottom=g.top+e.outerHeight();i.top=window.scrollY;i.bottom=i.top+document.body.clientHeight;i.left=window.scrollX;i.right=i.left+document.body.clientWidth;if(!k||k.length!=2||!d||d.length!=2){return false}switch(k[0]){case"top":switch(d[0]){case"top":if(g.top<i.top&&g.bottom>i.top&&h){if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"vertical",true)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"vertical",true)}}f.top=g.bottom-c.outerHeight()}else{if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"vertical",false)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"vertical",false)}}f.top=g.top}break;case"bottom":if(g.top-c.outerHeight()<i.top&&g.bottom>i.top&&h){if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"vertical",true)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"vertical",true)}}f.top=g.bottom}else{if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"vertical",false)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"vertical",false)}}f.top=g.top-c.outerHeight()}break}break;case"bottom":switch(d[0]){case"top":if(g.bottom+c.outerHeight()>i.bottom&&g.top<i.bottom&&h){if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"vertical",true)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"vertical",true)}}f.top=g.top-c.outerHeight()}else{if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"vertical",false)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"vertical",false)}}f.top=g.bottom}break;case"bottom":if(g.bottom>i.bottom&&g.top<i.bottom&&h){if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"vertical",true)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"vertical",true)}}f.top=g.top}else{if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"vertical",false)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"vertical",false)}}f.top=g.bottom-c.outerHeight()}break}break}switch(k[1]){case"left":switch(d[1]){case"left":if(g.left<i.left&&g.right>i.left&&h){if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"horizontal",true)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"horizontal",true)}}f.left=g.right-c.outerWidth()}else{if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"horizontal",false)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"horizontal",false)}}f.left=g.left}break;case"right":if(g.left-c.outerWidth()<i.left&&g.right>i.left&&h){if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"horizontal",true)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"horizontal",true)}}f.left=g.right}else{if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"horizontal",false)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"horizontal",false)}}f.left=g.left-c.outerWidth()}break}break;case"right":switch(d[1]){case"left":if(g.right+c.outerWidth()>i.right&&g.left<i.right&&h){if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"horizontal",true)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"horizontal",true)}}f.left=g.left-c.outerWidth()}else{if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"horizontal",false)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"horizontal",false)}}f.left=g.right}break;case"right":if(g.right>i.right&&g.left<i.right&&h){if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"horizontal",true)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"horizontal",true)}}f.left=g.left}else{if(c.hasClass("maxlength-display-target-parent")){c.find(".maxlength-display-target").each(function(){var l=a(this);j.setToggledCss(l,"horizontal",false)})}else{if(c.hasClass("maxlength-display-target")){j.setToggledCss(c,"horizontal",false)}}f.left=g.right-c.outerWidth()}break}break}c.css(f)};b.prototype.setToggledCss=function(f,v,w){var q=this,n=f.data("maxlength-display-toggle-"+v);if((w&&n!="active")||(!w&&n=="active")){if(n=="active"){f.data("maxlength-display-toggle-"+v,"").removeClass("maxlength-display-toggle-"+v)}else{f.data("maxlength-display-toggle-"+v,"active").addClass("maxlength-display-toggle-"+v)}switch(v){case"vertical":var g=f.css("margin-top"),l=f.css("margin-bottom"),t=f.css("padding-top"),m=f.css("padding-bottom"),p=f.css("border-top"),k=f.css("border-bottom"),s=f.css("border-top-left-radius"),d=f.css("border-top-right-radius"),o=f.css("border-bottom-left-radius"),h=f.css("border-bottom-right-radius");f.css({"margin-top":l,"margin-bottom":g,"padding-top":m,"padding-bottom":t,"border-top":k,"border-bottom":p,"border-top-left-radius":o,"border-top-right-radius":h,"border-bottom-left-radius":s,"border-bottom-right-radius":h});break;case"horizontal":var r=f.css("margin-left"),j=f.css("margin-right"),u=f.css("padding-left"),c=f.css("padding-right"),e=f.css("border-left"),i=f.css("border-right"),s=f.css("border-top-left-radius"),d=f.css("border-top-right-radius"),o=f.css("border-bottom-left-radius"),h=f.css("border-bottom-right-radius");f.css({"margin-left":j,"margin-right":r,"padding-left":c,"padding-right":u,"border-left":i,"border-right":e,"border-top-left-radius":d,"border-top-right-radius":s,"border-bottom-left-radius":h,"border-bottom-right-radius":o});break}}};b.prototype.objectifyCssString=function(g){var d={},f=g.split(";");for(var c in f){var e=a.trim(f[c]).split(":");if(e.length==2){d[a.trim(e[0])]=a.trim(e[1])}}return d};a.fn.maxLengthDisplay=function(c){if(c==null){c={}}new b(c,this);return this}})(jQuery);