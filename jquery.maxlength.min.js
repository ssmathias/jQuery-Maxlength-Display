(function(a){a.maxLengthDisplay={scope:"body",pinDefault:{target:"top-left",parent:"top-right"},allowPositionToggle:true,style:{},lengthDefinition:{"long":100,medium:50,"short":1,empty:0},init:function(){var b=a(this.scope);if(typeof b!="undefined"){b.find("input[maxlength], textarea[maxlength]").not(".maxlength-display-activated").each(function(){a.maxLengthDisplay.initializeElement(a(this))})}},calculateRemainingChars:function(d){if(typeof d.attr=="undefined"){d=a(d)}if(typeof d=="undefined"){return false}if(d.attr("maxlength")){var b=parseInt(d.attr("maxlength")),c=d.val().length;if(b===false){if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Could not parse integer from value: "+d.attr("maxlength"))}return false}if(b<=c){return 0}else{return b-c}}else{return false}},updateDisplayMarkup:function(h,c){var g=a.maxLengthDisplay.calculateRemainingChars(h),e="",b=-1,d;c=a(c);if(typeof c=="undefined"){return false}if(g===false){return false}d=c.data("maxlength-length-classes");for(var i in d){c.removeClass("maxlength-remaining-"+i);var f=d[i];if(g>=f&&f>b){e="maxlength-remaining-"+i;b=f}}c.addClass(e).html(g)},initializeElement:function(d){var c,b;if(typeof d.attr=="undefined"){d=a(d)}if(d.data("maxlength-display-initialized")=="true"){return true}c=parseInt(d.attr("maxlength"));if(typeof c=="undefined"||typeof c=="NaN"){if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Could not convert "+d.attr("maxlength")+" to an integer. Ignoring.");return false}}d.data("maxlength-display-initialized","true");if(!d.data("maxlength-display-target")){b=a.maxLengthDisplay.createDisplayTarget(d)}else{b=a("#"+d.data("maxlength-display-target"));d.focus(function(){b.addClass("maxlength-parent-has-focus")}).blur(function(){b.removeClass("maxlength-parent-has-focus")});a.maxLengthDisplay.setLengthDefinitionData(d,b);a.maxLengthDisplay.updateDisplayMarkup(d,b)}d.bind("keyup change",function(){a.maxLengthDisplay.updateDisplayMarkup(d,b)}).bind("keypress",function(g){var f=d.val().length;if(f+1>c){d.val(d.val().substring(0,c));g.stopPropagation();g.preventDefault()}});return true},getPinDefinition:function(e,b){var d={parent:["top","right"],target:["top","left"]},c=false;pinLocation=false;overridePinLocation=false;switch(b){case"parent":c=a.maxLengthDisplay.pinDefault.parent.toLowerCase().split("-");pinLocation=e.data("maxlength-pin-location");overridePinLocation=d.parent;break;case"target":c=a.maxLengthDisplay.pinDefault.target.toLowerCase().split("-");pinLocation=e.data("maxlength-target-pin-location");overridePinLocation=d.target;break}if(typeof pinLocation=="undefined"){pinLocation=c;if(!a.inArray(pinLocation[0],["top","bottom"])==-1){if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Invalid vertical pin location: "+pinLocation[0]+" - Overriding to "+overridePinLocation[0])}pinLocation[0]=overridePinLocation[0]}if(!a.inArray(pinLocation[1],["left","right"])==-1){if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Invalid horizontal pin location: "+pinLocation[1]+" - Overriding to "+overridePinLocation[1])}pinLocation[1]=overridePinLocation[1]}}else{pinLocation=pinLocation.toLowerCase().split("-");if(pinLocation.length!=2){if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Invalid pin location: "+pinLocation.join("-")+" - Using default.")}pinLocation=c}else{if(!a.inArray(pinLocation[0],["top","bottom"])==-1){if(a.inArray(c[0],["top","bottom"])){if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Invalid vertical pin location: "+pinLocation[0]+" - Using default.")}pinLocation[0]=c[0]}else{if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Invalid vertical pin location: "+pinLocation[0]+" - Overriding to "+overridePinLocation[0])}pinLocation[0]=overridePinLocation[0]}}if(!a.inArray(pinLocation[1],["left","right"])==-1){if(a.inArray(c[1],["left","right"])){if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Invalid horizontal pin location: "+pinLocation[1]+" - Using default.")}pinLocation[1]=c[1]}else{if(typeof console!="undefined"){console.warn("[jQuery Maxlength Display] Invalid horizontal pin location: "+pinLocation[1]+" - Overriding to "+overridePinLocation[1])}pinLocation[1]=overridePinLocation[1]}}}}return pinLocation},createDisplayTarget:function(h){var g=a("<div></div>"),c=a("<div></div>"),f={},d=a.maxLengthDisplay.allowPositionToggle,b=h.data("maxlength-allow-position-toggle");for(var e in a.maxLengthDisplay.style){f[e]=a.maxLengthDisplay.style[e]}if(h.data("maxlength-target-style")){overrideStyle=a.maxLengthDisplay.objectifyCssString(h.data("maxlength-target-style"));for(var i in overrideStyle){f[i]=overrideStyle[i]}}a.maxLengthDisplay.setLengthDefinitionData(h,c);a.maxLengthDisplay.updateDisplayMarkup(h,c);c.addClass("maxlength-display-target");if(typeof b!="undefined"){var b=h.data("maxlength-allow-position-toggle");if(b.length>0){b=a.trim(b.toLowerCase())}if(a.inArray(b,["true","false"])){d=(b=="true")}else{if(typeof console!="undefined"){console.warn('[jQuery Maxlength Display] allow position toggle value "'+b+'" not recognized. Ignoring override.')}}}g.addClass("maxlength-display-target-parent").css({"float":"left"}).append(c).data("maxlength-parent-pin",a.maxLengthDisplay.getPinDefinition(h,"parent")).data("maxlength-my-pin",a.maxLengthDisplay.getPinDefinition(h,"target")).data("maxlength-can-toggle",d).data("parent-id",h.attr("id"));a("body").append(g);c.width(c.width()).css(f);g.hide();a.maxLengthDisplay.updateDisplayLocation(h,g);h.focus(function(){c.addClass("maxlength-parent-has-focus");g.addClass("maxlength-parent-has-focus").show();a.maxLengthDisplay.updateDisplayLocation(h,g)}).blur(function(){c.removeClass("maxlength-parent-has-focus");g.removeClass("maxlength-parent-has-focus").hide()});if(a.maxLengthDisplay.allowPositionToggle){a(window).bind("scroll resize",function(){a.maxLengthDisplay.updateDisplayLocation(h,g)})}return c},setLengthDefinitionData:function(g,b){var c={},f,h,e,d;for(f in a.maxLengthDisplay.lengthDefinition){c[f]=a.maxLengthDisplay.lengthDefinition[f]}if(g.data("maxlength-length-classes")){h=a.maxLengthDisplay.objectifyCssString(g.data("maxlength-length-classes"));for(e in h){d=parseInt(h[e]);if(typeof d=="undefined"||typeof d=="NaN"){if(typeof console!="undefined"){console.warn('[jQuery Maxlength Display] - Override length class "'+e+'" value "'+h[e]+'" could not be parsed as an integer. Ignoring')}continue}c[e]=d}}b.data("maxlength-length-classes",c);return true},updateDisplayLocation:function(f,b){var c=b.data("maxlength-parent-pin"),i=b.data("maxlength-my-pin"),d={position:"absolute",top:"",left:""},e=((b.data("maxlength-can-toggle")!==undefined&&b.data("maxlength-can-toggle")===true)||(b.data("maxlength-can-toggle")===undefined&&a.maxLengthDisplay.allowPositionToggle===true)),g=f.offset(),h={};g.right=g.left+f.outerWidth();g.bottom=g.top+f.outerHeight();h.top=window.scrollY;h.bottom=h.top+window.innerHeight;h.left=window.scrollX;h.right=h.left+window.innerWidth;if(!c||c.length!=2||!i||i.length!=2){return false}switch(c[0]){case"top":switch(i[0]){case"top":if(g.top<h.top&&g.bottom>h.top&&e){if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",true)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",true)}}d.top=g.bottom-b.outerHeight()}else{if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",false)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",false)}}d.top=g.top}break;case"bottom":if(g.top-b.outerHeight()<h.top&&g.bottom>h.top&&e){if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",true)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",true)}}d.top=g.bottom}else{if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",false)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",false)}}d.top=g.top-b.outerHeight()}break}break;case"bottom":switch(i[0]){case"top":if(g.bottom+b.outerHeight()>h.bottom&&g.top<h.bottom&&e){if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",true)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",true)}}d.top=g.top-b.outerHeight()}else{if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",false)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",false)}}d.top=g.bottom}break;case"bottom":if(g.bottom>h.bottom&&g.top<h.bottom&&e){if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",true)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",true)}}d.top=g.top}else{if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",false)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",false)}}d.top=g.bottom-b.outerHeight()}break}break}switch(c[1]){case"left":switch(i[1]){case"left":if(g.left<h.left&&g.right>h.left&&e){if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"horizontal",true)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"horizontal",true)}}d.left=g.right-b.outerWidth()}else{if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",false)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",false)}}d.left=g.left}break;case"right":if(g.left-b.outerWidth()<h.left&&g.right>h.left&&e){if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",true)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",true)}}d.left=g.right}else{if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",false)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",false)}}d.left=g.left-b.outerWidth()}break}break;case"right":switch(i[1]){case"left":if(g.right+b.outerWidth()>h.right&&g.left<h.right&&e){if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",true)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",true)}}d.left=g.left-b.outerWidth()}else{if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",false)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",false)}}d.left=g.right}break;case"right":if(g.right>h.right&&g.left<h.right&&e){if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",true)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",true)}}d.left=g.left}else{if(b.hasClass("maxlength-display-target-parent")){b.find("maxlength-display-target").each(function(){var j=a(this);a.maxLengthDisplay.setToggledCss(j,"vertical",false)})}else{if(b.hasClass("maxlength-display-target")){a.maxLengthDisplay.setToggledCss(b,"vertical",false)}}d.left=g.right-b.outerWidth()}break}break}b.css(d)},setToggledCss:function(e,t,u){var m=e.data("maxlength-display-toggle-"+t);if((u&&m!="active")||(!u&&m=="active")){if(m=="active"){e.data("maxlength-display-toggle-"+t,"").addClass("maxlength-display-toggle-"+t)}else{e.data("maxlength-display-toggle-"+t,"active").removeClass("maxlength-display-toggle-"+t)}switch(t){case"vertical":var f=e.css("margin-top"),k=e.css("margin-bottom"),r=e.css("padding-top"),l=e.css("padding-bottom"),o=e.css("border-top"),j=e.css("border-bottom"),q=e.css("border-top-left-radius"),c=e.css("border-top-right-radius"),n=e.css("border-bottom-left-radius"),g=e.css("border-bottom-right-radius");e.css({"margin-top":k,"margin-bottom":f,"padding-top":l,"padding-bottom":r,"border-top":j,"border-bottom":o,"border-top-left-radius":n,"border-top-right-radius":g,"border-bottom-left-radius":q,"border-bottom-right-radius":g});break;case"horizontal":var p=e.css("margin-left"),i=e.css("margin-right"),s=e.css("padding-left"),b=e.css("padding-right"),d=e.css("border-left"),h=e.css("border-right"),q=e.css("border-top-left-radius"),c=e.css("border-top-right-radius"),n=e.css("border-bottom-left-radius"),g=e.css("border-bottom-right-radius");e.css({"margin-left":i,"margin-right":p,"padding-left":b,"padding-right":s,"border-left":h,"border-right":d,"border-top-left-radius":c,"border-top-right-radius":q,"border-bottom-left-radius":g,"border-bottom-right-radius":n});break}}},objectifyCssString:function(f){var c={},e=f.split(";");for(var b in e){var d=a.trim(e[b]).split(":");if(d.length==2){c[a.trim(d[0])]=a.trim(d[1])}}return c}};a(document).ready(function(){a.maxLengthDisplay.init()})})(jQuery);